### Documentation Refernced:

https://kubernetes.io/docs/reference/generated/kubernetes-api/v1.32/

https://kubernetes.io/docs/tasks/configure-pod-container/security-context/

#### Create 3 Namespace
```sh
kubectl create ns privileged-ns
kubectl create ns baseline-ns
kubectl create ns restricted-ns
```
#### Associate 3 Policy Levels for Namespaces
```sh
kubectl label namespace privileged-ns pod-security.kubernetes.io/enforce=privileged

kubectl label namespace baseline-ns pod-security.kubernetes.io/enforce=baseline

kubectl label namespace restricted-ns pod-security.kubernetes.io/enforce=restricted
```
### Testing

#### 1 - Privileged Pod 
```sh
kubectl run privileged-pod --image=nginx --privileged -n privileged-ns

kubectl run privileged-pod --image=nginx --privileged -n baseline-ns

kubectl run privileged-pod --image=nginx --privileged -n restricted-ns
```

#### 2 - Default Config Pod
```sh
kubectl run normal-pod --image=nginx -n privileged-ns

kubectl run normal-pod --image=nginx -n baseline-ns

kubectl run normal-pod --image=nginx -n restricted-ns
```
#### 3 - Pod Manifest for Restricted Namespace

nano restrcited-pod.yaml

```sh
apiVersion: v1
kind: Pod
metadata:
  name: restricted-pod
  namespace: restricted-ns
spec:
  containers:
  - name: secure-container
    image: busybox
    command: ["sleep", "3600"]
    securityContext:
      allowPrivilegeEscalation: false
      runAsNonRoot: true
      runAsUser: 1001
      capabilities:
        drop: ["ALL"]
      seccompProfile:
        type: RuntimeDefault
```
```sh
kubectl create -f restrcited-pod.yaml

kubectl get pods -n restricted-ns

kubectl delete -f restrcited-pod.yaml
```

Modify the manifest file to include `runAsUser: 1001` in securityContext
```sh
kubectl create -f restrcited-pod.yaml

kubectl get pods -n restricted-ns

kubectl exec -it restricted-pod -n restricted-ns -- sh

id

kubectl delete -f restrcited-pod.yaml
```
